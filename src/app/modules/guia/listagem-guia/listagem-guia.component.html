<div class = 'container px-0 pt-3 fix-max-width t'>
    
    <mat-card>

        <mat-card-title class = 'mat-elevation-z8'>

            <div class = 'pt-3 pl-3 pb-2'>
                Guia de Métricas
            </div>
            <mat-divider></mat-divider>
        </mat-card-title>
      

        
        <div>

            <mat-card-content class = 'mat-elevation-z4 mt-4'> 
                <mat-sidenav-container autosize>

                    <mat-sidenav opened mode="side">

                        <ul class="list-group list-group-flush">
                            <li (click) = 'this.filtraDisciplina(i.id);' class="list-group-item sidenav-el" *ngFor = 'let i of this.listaDisciplinasGuia'>
                                {{i.id + ' - ' + i.descricao}}                                 
                            </li>                          
                        </ul>       
                                   
    
                    </mat-sidenav>

                    <mat-sidenav-content>
                        <div class = 'wrapper mt-2'>
                            <mat-form-field>
                                <mat-label>Filtrar</mat-label>
                                <input matInput (keyup)="applyFilter($event)" placeholder="Ex. 2.1.2">
                              </mat-form-field>

                            <table mat-table [dataSource]="this.dataSource" multiTemplateDataRows class = 'mat-elevation-z4'>                     
                       
                                <ng-container matColumnDef="tarefa">
                                    <th mat-header-cell *matHeaderCellDef> Tarefa </th>
                                    <td mat-cell *matCellDef="let element"> {{element.tarefa + ' - ' + element.descricao_tarefa}} </td>
                                </ng-container>   

                                <ng-container matColumnDef="expandedDetail">

                                    <td mat-cell *matCellDef="let element" [attr.colspan]="colunas.length">
                                      <div class="example-element-detail"
                                           [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">  

                                        <div>
                                            <mat-expansion-panel class = 'mat-elevation-z4 mb-2' *ngFor = 'let i of this.agrupaComplexidadesTrf(element.itens)'>
                                                <mat-expansion-panel-header class = 'bg-secondary'>
                                                    <mat-panel-title class = 'text-light'>
                                                        {{i}}
                                                    </mat-panel-title> 
                                                </mat-expansion-panel-header>                                                  
                                               <hr>
                                                <table class="table mt-2 mb-2 mat-elevation-z4 fonte-item-guia">
                                                    <thead class="thead-dark">
                                                    <tr>
                                                        <th scope="col">Valor</th>  
                                                        <th scope="col">Componente</th> 
                                                        <th scope="col">Descrição</th>                                                     
                                                      </tr>
                                                    </thead>
                                                    <tbody>
                                                      <tr *ngFor='let j of this.filtraTrfPorComplexidade(element.itens, i)'>                                                        
                                                        <td>{{j.valor}}</td>     
                                                        <td>{{this.isNull(j.componente) ? "N/A" : j.componente}}</td>  
                                                        <td>{{j.descricao_complex}}</td>                                                     
                                                      </tr>                                                 
                                                    </tbody>
                                                </table>                                          

                                            </mat-expansion-panel> 
                                        </div>

                                      </div>
                                    </td>

                                  </ng-container>                   
                            
                                <tr mat-header-row *matHeaderRowDef="colunas; sticky: true"></tr>
                                <tr mat-row *matRowDef="let element; columns: colunas;"
                                class="example-element-row"
                                [class.example-expanded-row]="expandedElement === element"
                                (click)="expandedElement = expandedElement === element ? null : element">></tr>

                                <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
    
                            </table>
                            <mat-paginator [pageSizeOptions]="[10, 20]" showFirstLastButtons></mat-paginator>
                        </div>

                    </mat-sidenav-content>
                                
                </mat-sidenav-container>
    
                      
              
            </mat-card-content>
        </div>

    </mat-card>

</div>

